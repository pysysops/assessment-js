- job:
    name: jjb-update
    description: Task to update Jenkins on jjb changes.
    defaults: global
    node: master
    triggers:
     - pollscm: "* * * * *"

    logrotate:
      daysToKeep: 2
      artifactNumToKeep: 1

    scm:
     - git:
        url: https://github.com/pysysops/assessment-js.git
        skip-tag: true
        branches:
           - master

    builders:
     - shell: |
        #!/bin/bash
        set -e
        cd $WORKSPACE
        http_proxy= jenkins-jobs test -o "$(mktemp -d /tmp/jjb-update.XXXX)" jenkins
        http_proxy= jenkins-jobs --ignore-cache --flush-cache update --delete-old jenkins
